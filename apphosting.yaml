runtime:
  type: nextjs
  version: 1

services:
  - name: web
    source:
      repo: .
    env:
      # --- Public (client) envs: build + runtime ---
      - variable: NEXT_PUBLIC_FIREBASE_API_KEY
        value: AIzaSyBNwii__SATBn_pBwHHlKWhzD8UtZiYSp0
        availability: [BUILD, RUNTIME]

      - variable: NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN
        value: buckingham-secret-santa.firebaseapp.com
        availability: [BUILD, RUNTIME]

      - variable: NEXT_PUBLIC_FIREBASE_DATABASE_URL
        value: https://buckingham-secret-santa-default-rtdb.europe-west1.firebasedatabase.app
        availability: [BUILD, RUNTIME]

      - variable: NEXT_PUBLIC_FIREBASE_PROJECT_ID
        value: buckingham-secret-santa
        availability: [BUILD, RUNTIME]

      - variable: NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET
        value: buckingham-secret-santa.appspot.com
        availability: [BUILD, RUNTIME]

      - variable: NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID
        value: 507395963979
        availability: [BUILD, RUNTIME]

      - variable: NEXT_PUBLIC_FIREBASE_APP_ID
        value: 1:507395963979:web:f61a4daee0b4484363e1ce
        availability: [BUILD, RUNTIME]

      # --- App URL for links in emails (ROOT domain; no path) ---
      - variable: PUBLIC_APP_URL
        value: https://buckingham-secret-santa-app--buckingham-secret-santa.us-central1.hosted.app
        availability: [RUNTIME]

      # --- Server-only secrets (runtime only) ---
      - variable: FIREBASE_PROJECT_ID
        secret: FIREBASE_PROJECT_ID
        availability: [RUNTIME]

      - variable: FIREBASE_CLIENT_EMAIL
        secret: FIREBASE_CLIENT_EMAIL
        availability: [RUNTIME]

      - variable: FIREBASE_PRIVATE_KEY
        secret: FIREBASE_PRIVATE_KEY
        availability: [RUNTIME]

      # Email secrets are optional for now (assign route will need them)
      - variable: SMTP_HOST
        secret: SMTP_HOST
        availability: [RUNTIME]

      - variable: SMTP_PORT
        secret: SMTP_PORT
        availability: [RUNTIME]

      - variable: SMTP_SECURE
        secret: SMTP_SECURE
        availability: [RUNTIME]

      - variable: SMTP_USER
        secret: SMTP_USER
        availability: [RUNTIME]

      - variable: SMTP_PASS
        secret: SMTP_PASS
        availability: [RUNTIME]

      - variable: MAIL_FROM
        secret: MAIL_FROM
        availability: [RUNTIME]
